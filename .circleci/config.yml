version: 2.1
jobs:
    build:
        docker:
            - image: alpine:latest
        steps:
            - checkout
            - run:
                name: Install some necessary dependencies
                command: |
                    apk add --no-cache build-base cmake autoconf libtool pkgconf git mercurial file linux-headers wget libc-dev
            - run:
                name: Pull submodules
                command:
                    git submodule update --init --recursive
            - run:
                name: Download and install OpenSSL
                command: |
                    cd /tmp
                    export OPENSSL_VERSION=1.1.1d
                    wget https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz && tar xf openssl-${OPENSSL_VERSION}.tar.gz
                    cd openssl-${OPENSSL_VERSION} && ./config -fPIC && make && make install
            - run:
                name: Build our software
                command: |
                    mkdir build
                    cd build
                    cmake ..
                    make
